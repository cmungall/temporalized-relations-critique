\documentclass{bioinfo}
%\documentclass{article}
\input{logicmacros}
\usepackage{url}


\ifx\pdfoutput\undefined
% we are running LaTeX, not pdflatex
\usepackage{graphicx}
\else
% we are running pdflatex, so convert .eps files to .pdf
%\usepackage[pdftex]{graphicx}
%\usepackage{epstopdf}
\fi 

\copyrightyear{}
\pubyear{}

\def\partOf{\pr{part\_of}}
\def\hasPart{\pr{has\_part}}
\def\isA{\pr{is\_a}}
\def\instanceOf{\pr{instance\_of}}
\def\derivesFrom{\pr{derives\_from}}
\def\adjacentTo{\pr{adjacent\_to}}

\def\existsAt{\pr{exists\_at}}

\def\partOfAtSomeTimes{\pr{part-of-at-some-times}}
\def\partOfAtAllTimes{\pr{part-of-at-all-times}}
\def\hasPartAtSomeTimes{\pr{has-part-at-some-times}}
\def\hasPartAtAllTimes{\pr{has-part-at-all-times}}
\def\hasPartAtAllTimesForWhichPartExists{\pr{has-part-} \pr{at-all-times-}\ \pr{for-which-part-exists}}
\def\partOfAtAllTimesForWhichWholeExists{\pr{part-of-} \pr{at-all-times-}\ \pr{for-which-whole-exists}}

\def\atAllTimes{\pr{at-all-times}}
\def\atSomeTimes{\pr{at-some-times}}
\def\atAllTimesForWhichPartnerExists{\pr{at-all-times-for-which-partner-exists}}

\def\CellNucleus{\pr{cell nucleus}}
\def\Cell{\pr{cell}}

\def\OBOREL{\textbf{OBO-REL}}

\newcommand{\tbleqn}[1]{
\begin{math}
\begin{aligned}[1]
#1
\end{aligned}
\end{math}
}

\begin{document}
\firstpage{1}

\title{A critique of temporalized relations}

\author{Christopher J. Mungall\,$^{1}$\footnote{to whom correspondence should be addressed}}
\address{$^{1}$Genomics Division, Lawrence Berkeley National Laboratory, MS84R017, 1 Cyclotron Road, Berkeley, CA 94720 USA}

\history{}

\editor{}

\maketitle

\begin{abstract}

  In this review I evaluate the proposed new temporalized relations
  strategy in which many existing relations would be replaced by two
  or more relations, an \emph{at-all-times}\ form and an
  \emph{at-some-times}\ form.

  My findings are that the \emph{at-all-times}\ relations have an
  underlying logical problem that renders them formally incorrect for
  use in many ontologies. The \emph{at-some-times} relations are
  safer, but would lose crucial transitive inferences. These logical
  problems are compounded by the fact that the relations are difficult
  for users and ontology developers to understand, and will most
  likely lead to confusion and errors, especially in the absence of
  detailed documentation.

  I conclude that these relations should not be adopted by ontology
  developers as a replacement for existing relations. Migrating to
  these relations would be an expensive, error-prone process that
  would alienate the user base of an ontology, and the end result
  would be ontologies that are either formally incorrect or too weak
  to perform required inferences.

\end{abstract}

\section{Introduction}

\subsection{The OBO Relations ontology}


The OBO relations ontology (\OBOREL) defined a set of core relations
for use in biological ontologies, including \isA, \partOf\ and
\derivesFrom\cite{Smith2005}. The original \OBOREL\ paper has been
cited 709 times\footnote{Google scholar}, and has been a crucial
reference in the correct usage of relations in biological ontologies.

One notable aspect of \OBOREL\ was the precise specifications of how
relationships change or remain the same through the passage of
time. For example, the intent was that an ontology could state that
\emph{every} \CellNucleus\ is part of \emph{some} \Cell\ at \emph{any}
given moment of time (for which that cell nucleus exists). This has a
precise interpretation in first-order logic:

$
\A x \A t : \instanceOf(x, \CellNucleus, t) \imp \\
 \E y \instanceOf(y, \Cell, t), \partOf(x,y,t)
$

A relationship of this form is known as \emph{permanent generic
  parthood}. It allows for nuclei to be passed from one cell to
another, so long as the nucleus remains part of some cell.

The other notable aspect of \OBOREL\ was the distinction between type
(class) level and instance level relations. Each type-level relation
connects a pair of classes and typically is defined according to an
\pr{ALL-SOME-ALLTIMES}\ pattern - for example, every cell nucleus is
part of some cell at all times. This causes some confusion when using
OWL, which does not support these kinds of class-level
relationships. Instead the relationship between a nucleus and a cell
in OWL is explicitly quantified, but without a time argument, as all
relations in OWL are binary: For example:

\begin{verbatim}
'cell nucleus' SubClassOf part_of some cell
\end{verbatim}

As of 2010, the official semantics of OBO format
have been as a subset of OWL, so what applies to OWL necessarily
applies to OBO.

This impedance mismatch between the OWL interpretation (which can be
considered ``atemporal'') and the \OBOREL\ account has been
problematic in providing a consistent formal account of relations that
is consistent with OWL semantics, although it is not clear that this
has caused a problem for many ontology developers or users. The
standard approach has been to use a set of binary relations as
specified in Table \ref{tab:characteristics-atemporal}, and to assume
an \OBOREL\ type interpretation for time.

\subsection{BFO2 and temporalized relations}

One of the stated goals of the group developing the OWL translation of
version 2 of the Basic Formal Ontology (BFO)\cite{Grenon2004} was to
have relations in OWL handled so as to have a clear First-Order Logic
(FOL) reading according to the BFO reference\cite{BFO2Ref}. The BFO
group explored different strategies for unifying OWL binary properties
with the ternary relations\cite{Grewe}.  One such strategy is the
\emph{temporalized relations} (TR) strategy, in which each reference
relation relating continuants has two or more OWL cognates,
\pr{rel-at-some-times} and \pr{rel-at-all-times}. This strategy has
been adopted as the official one for the OWL translations of
BFO2\cite{Graz}.

\subsection{Outline}

In this review I do not attempt to compare or even describe the
different modeling possibilities (see \cite{Grewe} for details here);
due to pressure to make temporalized relation the standard for OBO
library ontologies I focus purely on this approach.

I first provide an outline of temporalized relations, drawing on the
existing release notes and documentation, attempting to fill some gaps
and provide additional explanations of some of the complexities. I
then present the major problems posed by these relations:

\begin{enumerate}

\item Temporalized relations are logically flawed. Their meaning is
  opaque to OWL, decreasing our ability to use reasoners to detect
  errors and build ontologies. The approach is inherently constrained,
  and fail to capture dynamic situations, forcing ontology editors to
  make a choice between two unsatisfactory models. 

\item Temporalized relations would lead to an unacceptable increase in
  complexity in most ontologies.

\end{enumerate}

These problems are inter-related; the complexity of the approach with
its proliferation of relations masks underlying logical
problems. Ontology editors who do not understand the formalism are
more likely to make errors, both in migrating to temporalized
relations, and in maintaining ontologies that use them.

Finally I end with some concrete recommendations regarding the
temporalized relation strategy.

My intentions are to make this review accessible to a wide audience,
and to keep logical formulas to a minimum. This is difficult because
to understand the motivations of the TR approach and the underlying
problems it is necessary to understand some of the logical
underpinnings. I have annexed some of the finer grained details into
an appendix, and attempted to stick with examples a biologist would
understand.

\begin{table}
\begin{tabular}{ | p{2.5cm} | p{1cm} | p{1cm} | p{2.5cm} | }
\hline
\textbf{Relation} & \textbf{Trans} & \textbf{Symm} & \textbf{Inverse Of}  \\
\hline
\partOf\  & Yes & No & \hasPart  \\
\hline
\hasPart\ & Yes & No & \partOf \\
\hline
\adjacentTo\ & No & Yes &  \\
\hline
\end{tabular}
\caption{Relation characteristics, atemporal. These are the characteristics of the instance level relations in the current RO (http://obo-relations.googlecode.com)}
\label{tab:characteristics-atemporal}
\end{table}


\section{Temporalized Relations}

Here I distinguish between reference relations (RRs) and their
manifestation in OWL as binary temporalized relations (TRs), using the
temporalized relation strategy (TRS). All relations are instance
level. As a typographic convention I use dashes to separate the words
in a temporalized relation, and underscores in a reference relation.

\subsection{Translation template}

The BFO2 Graz version release notes\cite{Graz} specify a general
template for relating RRs to TRs:

\begin{verbatim}
x rel-at-some-time y ->
 exists(t) exists_at(x,t) -> 
    exists_at(y,t) and rel(x,y,t)
x rel-at-all-times y ->
  forall(t)  exists_at(x,t) -> 
      exists_at(y,t) and rel(x,y,t)
\end{verbatim}

Here I focus on \partOf\ as an exemplar relation, whilst recognizing
that similar patterns may apply to other, but not all relations.

For \partOf\ connecting two continuants there are in fact \emph{three}
TRs rather than two (for reasons that will be explained shortly):

\begin{enumerate}

\item \partOfAtSomeTimes

\item \partOfAtAllTimes

\item \partOfAtAllTimesForWhichWholeExists

\end{enumerate}

Note that in BFO2 the actual labels are ``part of continuant at some
time'', ``part of continuant at all times'' and ``part of continuant
at all times for which whole exists'', I shorten this for brevity --
here we are only concerned with relations that involve a continuant.

\subsection{TRs have a different meaning from OBOREL relations}

On the surface, the \atAllTimes\ form appears to be the same as the
\OBOREL\ interpretation. For example, an ontology that uses TRs may
include the following OWL axiom:

\begin{verbatim}
'cell nucleus' SubClassOf
   part-of-at-all-times some cell
\end{verbatim}

This may seem to be the same as the statement ``every cell nucleus is
part of some cell at all times''. We might even be able to
automatically translate an ontology written using the \OBOREL\
interpretation into TRs. \emph{However, these are NOT the same, and an
  understanding of why this is so is crucial if these relations are to
  be used correctly, and to understand the long-term consequences of
  using them}.

It is not the case that TRs are the same as what has come before, but
with longer labels. \emph{The semantics are fundamentally different}.
This has major effects on both the OWL axioms that are crucial for
reasoning over ontologies, and on the FOL reading of what the axioms
in the ontology means. See \textbf{table \ref{tab:fol-class-axioms}}
in the appendix to compare the FOL for TRs vs \OBOREL. For readers not
versed in FOL, I will next provide an outline of how the TR semantics
affect the OWL \emph{characteristics} of these relations in some ways
that might seem surprising. I will return to this in the evaluation to
show how this affects real-world ontology modeling.

\subsection{Object property characteristics}

In OWL, relations (object properties) can have certain characteristics
such as being \emph{transitive}, \emph{symmetrical}, and they may be
related to other relations via logical axioms such as \emph{inverse
  properties} and property chains. These are extremely useful for many
purposes - transitivity has been at the core of bioinformatics
applications of ontologies from the initial version of the Gene
Ontology\cite{Ashburner2000}, if not before. Inverse properties are
useful for instance level reasoning, and for finding errors in complex
ontologies.

When translating a RR to a TR, it may not be immediately clear what
properties of the RR should be carried over to the TR. If a reference
relation $R$ has an inverse $R'$, it does not follow that the
temporalized versions will be inverses. Here I use \partOf\ as an
illustrative example, although each relation may require individual
examination for its properties.

Figure \ref{fig:part} shows the characteristics of continuant parthood
relations, both atemporal (A) and temporalized (B).

%----------------------------------------
\begin{figure}
\center
\includegraphics[width=7cm]{part}
\caption{Parthood relations, both atemporal (A) and temporalized
  (B). The atemporal form can be found in the current RO. The more
  complex temporalized form can be seen in the BFO2 Graz release}.
\label{fig:part}
\end{figure}
%----------------------------------------


\subsubsection{Transitivity}

In the case of the RR \partOf\ (which is transitive), the stronger
\atAllTimes\ TR retains the transitivity characteristic, whereas the
weaker \atSomeTimes\ TR does not have this. This means the weaker
version is often (but not always) safer to use in an ontology, but
will in general lead to fewer inferences.

\subsubsection{Symmetricality}

For other relations and other characteristics, the translation may not
be obvious. For example, the adjacency relation is symmetric in its
atemporal form\footnote{I am only considering instance level
  relations}. The symmetricality property should only be carried over
in the weaker \atSomeTimes\ form\footnote{BFO2 does not have an
  adjacency relation, this reflects my assumption about what the
  axioms should be}. Table \ref{tab:characteristics-adj} shows the
characteristics.

\subsubsection{Sub Properties}

The general template for a TR hierarchy is one in which \atSomeTimes\
is the most general, with sibling sub-properties \atAllTimes\ and
\atAllTimesForWhichPartnerExists. This is illustrated for parthood in
figure \ref{fig:part}.

[need more verbiage on why the hierarchy is like this. proofs?]

Note how this interacts with other properties. Given:
$$x\ \adjacentTo\ \atAllTimes\ y$$

We infer:

$$y\ \adjacentTo\ \atSomeTimes\ x$$

\subsubsection{Inverse Properties}

Ontologies frequently declare inverse relations. For example, the
RR \partOf\ is the inverse of \hasPart. This is fairly standard
practice, and the inverse relations are extremely useful for
reasoning. 

The inverse of the TRs of \partOf\ may not be completely
intuitive. Naively we might guess that \partOfAtAllTimes\ would be the
inverse of \hasPartAtAllTimes, but this not the case.

In fact, the declaring the inverse of \partOfAtAllTimes\ requires
declaring a third, more specific, TR form,
\hasPartAtAllTimesForWhichPartExists. This is illustrated in
\ref{fig:part}(B).

The \atAllTimesForWhichPartnerExists\ form is be generated for some
but not all RRs.

\subsubsection{Property Chains}

Property (relation) chains are an OWL construct that allows a reasoner
to infer that a chain of relationships of a specified type infers
another relationship type. For example, the rule that if $x$ has part
$y$ and $y$ is part of $z$ then $x$ overlaps $z$ is written as:

\begin{verbatim}
has_part o part_of -> overlaps
\end{verbatim}

These chains have proven extremely useful for a number of
bio-ontologies. Translating these into temporalized form is
complicated and leads to multiplication of axioms. I omit discussion
of this for space reasons here, see the BFO
tracker\footnote{http://code.google.com/p/bfo/issues/detail?id=157}
for further details.

\subsubsection{Other characteristics}

I do not consider other characteristics such as anti-symmetry and
domain/range restrictions here[perhaps future versions].

\subsection{TR formalism summary}

I have presented a brief overview of how reference relations are
translated to the more complicated temporalized form, using \partOf\
as the main example. It should be noted that many - perhaps the
majority - of relations will have to be temporalized in this way if a
TR approach is to be adopted. 

\begin{table}
\begin{tabular}{ | p{3cm} | p{1cm} | p{4cm} | }
\hline
\textbf{Relation} & \textbf{Symm} & \textbf{Inverse Of}  \\
\hline
\adjacentTo\ \atSomeTimes & Yes & \adjacentTo\ \atSomeTimes \\
\hline
\adjacentTo\ \atAllTimes & No & \\
\hline
\end{tabular}
\caption{Relation characteristics for adjacency, a symmetric
  relation. Note that in contrast to \partOf\ and transitivity, it is
  the weaker form of the relation that inherits the characteristic}
\label{tab:characteristics-adj}
\end{table}

\section{Evaluation}

My evaluation is split into two parts: (1) logical problems with the
TR approach, leading to incorrect ontologies and limiting the utility
of reasoners (2) the inherent complexity of the TR relations.

These two problems are intertwined. The TR approach with its inflation
of relations and axioms is so complex that many of the problems
highlighted here were not immediately obvious.

\subsection{Temporalized relations are logically flawed}

TRs present many challenging problems. For example, when converting an
anatomy ontology that has been modeled traditionally using the
relations in figure \ref{fig:part}(A), the ontology editor must make a
choice on a case by case basis as to which of the relations in
\ref{fig:part}(B) should be used.

This is an onerous task, but this could be justified if the results
were better ontologies. However, in many cases \emph{none of the
  choices are appropriate}, resulting in an ontology that is
\emph{worse} in terms of formal correctness and reasoning power.

\subsubsection{Temporalized relations lead to loss of error-checking
  capabilities}

The complexity and relation inflation of the TR approach is a
potential cause of curator error in ontologies - editors will require
additional training and even then subtle errors cause by using the
wrong temporalized form will be common.

This problem could be mitigated if we could use reasoners to check for
common errors. In fact, the use of TRs \emph{lessens} the power of
reasoners to detect errors.

As an example, consider the powerful part-disjointness
pattern\cite{PD} which has been very useful for error checking in GO
and anatomical ontologies. This allows us to state that nothing is
part of both a mitochondrion and a nucleus:

\begin{verbatim}
(part_of some mitochondrion) 
  DisjointWith (part_of some nucleus)
\end{verbatim}

When we try and extend this to TRs we are faced with the choice of
relation to use. The default choice would be the stronger \atAllTimes\
form:

\begin{verbatim}
(part-of-at-all-times some mitochondrion) 
  DisjointWith
 (part-of-at-all-times some nucleus)
\end{verbatim}

However, on the FOL level, this is far too \emph{weak}. This weakness
carries over to the OWL as well, and it is easy to demonstrate errors
that reasoners cannot catch (for example, chromosomes being part of
both mitochondria and nuclei). See the BFO tracker for
full details\footnote{http://code.google.com/p/bfo/issues/detail?id=156}.

In order to approximate the level of error checking we have without
TRs, it's necessary to add 4 axioms, for each of \atAllTimes\
possibilities.

\begin{verbatim}
(part-of-at-all-times some mt)
  DisjointWith
(part-of-at-all-times some nucleus)
(part-of-at-all-times some mt)
  DisjointWith
(part-of-at-all-times-that-whole-exists
  some nucleus)
(part-of-at-all-times that whole exists
  some mt)
  DisjointWith 
(part-of-at-all-times-that-whole-exists
  some nucleus)
(part-of-at-all-times some nucleus)
  DisjointWith
(part-of-at-all-times-that-whole exists
  some mt)
\end{verbatim}

Even with this additional complexity, the FOL still falls short of
what is required.

It is simply not practical for ontology editors to have to write all
such possible forms.

\subsubsection{Temporalized Relations can not represent certain types
  of relationships}

One reason why TRs are formally incorrect for many ontologies is
because most appropriate choice of parthood relationship is the
\emph{permanent-generic} form, as exemplified in the original OBO
relations paper. The standard example here is the relationship between
a \textbf{cell nucleus} and a \textbf{cell}. At any moment in time, a
given cell nucleus is by definition part of some cell. However,
\emph{this need not be the same cell throughout the lifetime of the
  nucleus}.

In contrast, if the \partOfAtAllTimes\ TR is used then the
interpretation is that the cell nucleus is always part of the same
cell. This interpretation can be proved to be formally wrong in cells
that undergo cell division\cite{CellDiv}. This is because in reality
the cell nucleus is always part of a cell, \emph{but not the same
  cell}. With \partOfAtAllTimes\, there is no ``migration'' allowed -
a nucleus is always part of the same cell.

This is likely to cause problems when the ontology is used to model
instance data\footnote{Difficult to evaluate this at this time, as the
  current BFO2 TR proposal does not suggest how instances are to be
  modeled}. Even if we do not use instance data, this exposes an
inherent contradiction in the TR approach:

\begin{enumerate}

\item The primary justification for incurring the complexity of TRs is
  that they are necessary to achieve a clear FOL reading of the OWL
  model.

\item By adopting the TR approach we are forced to make statements
  in OWL that are \emph{false} in the FOL reading.

\end{enumerate}

An ontology editor might choose to circumvent this problem by choosing
the weaker \partOfAtSomeTimes\ relation, but this would lose
transitivity, which is widely viewed to be an unacceptable compromise.

To summarize this issue, in the nucleus-cell case (which is
representative of many others), the ontology editor requires the
permanent generic form in order to be both accurate and to get the
required inferences. However, this form is specifically excluded in
the existing TR strategy, forcing the ontology editor to make
statements that are formally incorrect.

\subsubsection{Temporalized relations are ill-equipped to model change}

The constraints imposed by TRs are wider than the lack of
permanent-generic relationships, as exemplified in the nucleus-cell
example. The problems extend to a much wider range of ontology
classes, including classes whose members change with respect to some
property (such as location) over time. TRs are fundamentally
ill-equipped to deal with these.

As an example, consider the class \textbf{premigratory neural crest
  cell}. This is a cell that is part of the \textbf{neural
  crest}\footnote{here we use the term 'neural crest' to denote the
  region of the neuroepithelium}, prior to migration. In the Cell
Ontology, this is modeled as:

\begin{verbatim}
'premigratory neural crest cell' 
  SubClassOf part_of some 'neural crest'
\end{verbatim}

Ontology editors interpret this correctly according to the \OBOREL\
interpretation, in that the parthood relationship is true during the
period in which the cell instantiates the premigratory type.

In choosing the correct TR for this relationship we have the choice of
whether to go with the weaker \atSomeTimes\ or the stronger
\atAllTimes. Again, the weaker relation loses transitivity; the
stronger relation is formally wrong, because the cells can
migrate. Making a false statement here will inevitably lead to major
problems and contradictions later on. If the ontology contains false
statements it will lead to confusion on the part of the users and
developers of ontologies. It certainly complicates the task of those
of us who train ontology developers.

This particular problem with TRs arises as a direct consequence of the
next problem, the inability of the approach to model \emph{non-rigid
  classes}.

\subsubsection{Temporalized relations are incompatible with vital
  non-rigid classes}

The TR approach disallows instantiation of classes that are
\emph{non-rigid}, which is a severe constraint when developing
ontologies that deal with things that change over time.

The BFO2 Graz release notes\cite{Graz} state:

\begin{quotation}

  Thus we only instantiate ``rigid'' classes, as the interpretation we
  take is a rdf:type C $\Rightarrow$ forall(t) a exists at t $\imp$ a
  instance of C at t. Temporally restricted instantiation is not
  supported in this version of BFO in OWL. We are working on it for
  the future.

\end{quotation}

To many users this may seem like an obscure point, but this is
actually a severe restriction. A class is rigid if it is instantiated
``for life''. If an individual transforms from being an instance of
one class of thing to another class, then those classes are not rigid.

An example of a rigid class may be ``Homo sapiens''. If an individual
instantiates this class at some time t, then they instantiate it all
times for which they exist (barring some unusual inter-species
transformation). Upper level categories like 'process' are also rigid.

The following classes are non-rigid, and therefore do not have full
support in this version of BFO / the TR approach:

\begin{enumerate}

  \item 'premigratory neural crest cell'
  \item 'human with Parkinson's disease'
  \item 'female organism'
  \item 'infected lung'
  \item 'professor' (but \emph{professor role} is allowed)
  \item 'human patient' (but \emph{patient role} is allowed)
  \item 'oocyte'
  \item 'fractured bone'
  \item 'happy human'
  \item 'fetal heart'
  \item 'open heart valve'
  \item 'gravid uterus'
  \item 'phosphorylated EGFR protein'
  \item 'cytoplasmic NFkB'
  \item any leaf node from PATO

\end{enumerate}

See the appendix for a full discussion of each of these cases.

In some cases the constraint may not be so onerous. It can be argued
that a well-structured ontology would never include a class
``professor'', and that this should always be modeled using a rigid
class (human) plus a role (professor role). However, these decisions
should be made on a case by case basis for each ontology that than
imposed from above.

In many of other other cases, forcing the ontology developer to
exclude some of the classes above is too onerous. For example, many
anatomical ontologies make use of phase or stage as a
differentia. This TR constraint is therefore not acceptable for
anatomy ontology developers.

Whilst technically the BFO2 release notes only state that
instantiation of non-rigid classes is not supported, I showed
previously with the neural crest cell example that non-rigid classes
are not compatible with the TR approach. It is impossible to
adequately represent the parthood relationships for classes such as
'premigratory neural crest cell' using the existing TR strategy.

It is in fact impossible to specify the defining relationship for
non-rigid classes using TRs, as these will be by definition wrong on
the FOL level.

It may be the case that future versions of the TR strategy will allow
for non-rigid classes. It is not clear how this will be achieved
without additional complexity.  The TR strategy must be evaluated on
what exists presently, rather than what it might become in the future,
and at this time the strategy comes with major constraints that
ontology developers should be fully aware of.

In terms of BFO2 there is a particular disconnect when it comes to
qualities - this is covered in the appendix.

To summarize this criticism: non-rigid classes are commonly used in
many biological ontologies. Instantiation of these classes are not
supported in this version of the TR approach, and attempts to specify
defining relationships for these classes are formally wrong on the FOL
level.

\subsection{Temporalized relations add considerable complexity}

In addition to logical problems with TRs, the complexity they incur
causes significant problems - including obscuring the logical
problems.

\subsubsection{Temporalized relations proliferate relations in a complex network}

The most striking feature of an ontology that uses the TR strategy is
the complexity. Whereas using traditional modeling, we may have has a
single parthood relation, we now have three, arranged in a
counter-intuitive network of axioms; contrast (A) and (B) in figure
\ref{fig:part}. Note that in fact this figure is a simplification, as
it does not show other sub-properties, such as the member part
relations. In production ontologies, most relations involving
continuants would have to be split in this way. Many relations are
inter-related via property chains and other axioms, it is as yet
unclear how much complexity an ontology rich in relations would
suffer.

\subsubsection{Multiple levels of quantification}

Another source of complexity is that ontology editors now have to
handle an extra layer of quantification. Consider some of the possible
ways to model the relationship between a population of organisms and
an organism:

\begin{verbatim}
1. population SubClassOf 
  has-part-at-some-time some organism
2. population SubClassOf 
  has-part-at-all-times some organism
3. population SubClassOf 
  has-part-at-all-times-that-part-exists
    some organism
4. population SubClassOf 
  has-part-at-some-time only organism
\end{verbatim}

In each case there is in fact three levels of quantification. The
first level is the OWL subclass axiom, which states that the condition
holds for ALL instances of a population. Also within the scope of OWL
is the final SOME or ONLY quantifier. Finally, embedded within the
relation is an additional layer is the temporal quantification. Note
that this final layer is opaque to OWL reasoners (and thus harder to
use standard tools to check).

This is in contrast to the simpler, well-documented kind of atemporal
quantification ontology developers perform at the moment.

(Note that \emph{none} of the axioms above are correct, given that
populations gain and lose members over time - permanent generic
parthood is required).

I have a great deal of experience in training and assisting ontology
developers in the use of tools such as reasoners and in making the
transition to OWL. In my estimation, the level of complexity TRs exert
is simply too high.

\subsubsection{Migration is complex and will be error-prone}

In theory some of this complexity could be tamed by additional tooling
(although it is not clear who has the resources to implement
this). However, even if this complexity can be hidden from the user,
the ontology developer is forced to wrestle with the complexity if
they are to use the relations correctly.

This complexity first manifests when an ontology developer chooses to
migrate from a traditionally modeled ontology using non-temporalized
relations to a TR model.

The ontology developer must choose on a case by case basis how to
translate each axiom. It may be tempting to translate all to the
\atAllTimes\ form, but as I noted previously in the spatial
disjointedness case, this can lead to unexpected problems. In
addition, the \atAllTimes\ relation is often formally wrong on the FOL
level.

Even in cases where there is an optimal way to translate to TRs,
performing the conversion requires an ontology developer who has a
strong understanding of the domain and of the logic. In my estimation
many mistakes will be made in this process.


\section{Discussion}

\subsection{Keep it as simple as possible, but not simpler}

Many engineers abhor solutions that appear overly baroque or complex
compared to the task at hand. From the point of view of the person
proposing the complex solution, this can be frustrating and seem like
short-sightedness on the part of the engineers. It may be tempting to
dismiss this as a lack of vision to foresee the time in the future
when the complexity of the solution will be justified.

Based on my experience in software and ontology engineering, I firmly
believe we should take heed of engineers'
concerns. \textbf{Extraordinary complexity demands extraordinary
  justification}.  I have discussed the TR solution with a number of
people with expertise ranging from ontology engineering,
bioinformatics, biology and formal logic. Most of them find the TR
solution excessively complex, unjustified by any use case, and those
with an understanding of the logic realize the underpinnings are
flawed. Perhaps we are collectively shortsighted or missing some
aspect of the bigger picture? But even if this were the case, the fact
that such a large section of the community finds the solution to be so
unworkable demands means that the proponents of the solution need to
work especially hard to justify the complexity.

\subsection{On the strengths and weaknesses of OWL}

One of the stated goals of the BFO2 OWL project is to have a clear FOL
reading of the OWL according to BFO. This is a laudable aim but must
be balanced against the needs of real-world users of ontologies. Their
requirements should not be trumped by the desire for formal perfection.

We must also consider whether OWL is the best mechanism for achieving
this kind of perfection. OWL is by design more restricted than
first-order logic (which is itself arguably inadequate to model
biology in anything other than a simplistic fashion). These
restrictions make it more suited to certain kinds of tasks than
others. In my experience OWL is tremendously useful for building and
maintaining terminological networks that model the world in a very
simple (but very useful) fashion. It's important to remember that we
are working with approximations. Perhaps it is the case that
attempting a perfect FOL reading of an OWL version of the BFO2 spec is
simply using OWL in the wrong way? I have demonstrated in this report
how reasoners become less useful as more is hidden from them (see the
spatial disjointness example).

Whilst I would argue that we should be prepared for the fact that the
OWL approximation may not have a perfect reading in terms of the BFO2
FOL, there may be reasons to be optimistic that this reading can be
achieved without the sacrifices of the TR approach. For example, it
may be possible to have a dual interpretation, or to use an approach
called temporally qualified continuants (TQCs). These may have the
benefit of being more closely aligned with the original \OBOREL\
paper. This is outside the scope of this paper, see \cite{Grewe} for
details.

\subsection{Recommendations}

Based on my evaluation I make the following three primary
recommendations:

\begin{enumerate}

\item \textbf{Do not use.} My primary recommendation is that
  Temporalized Relations should not be used as a replacement for
  existing atemporal relations. Ontologies should not migrate their
  production branch to TRs.

\item \textbf{Use the traditional approach.} Ontology developers
  should continue using the relations that they have been using
  successfully for years. These relations should be given stable
  identifiers and be resolvable. If a clearly better approach than the
  default strategy arrives then like any identifier they can be
  obsoleted, but this should only happen when the new approach is
  demonstrably superior.

\item \textbf{Change priorities.} Dogma should not trump the
  requirements of users of ontologies. A clear reading of the OWL in
  terms of the FOL is laudable but may have to be postponed.

\end{enumerate}


I am not against the continued investigation of TRs as a long term
strategy. My additional recommendations here are:

\subsubsection{Mark as experimental.} These relations should be clearly
marked as experimental.

\subsubsection{Documentation.} More documentation is required. This
includes both user-level documentation (for example: how do I choose
the right temporalized form?) and documentation for the experienced
engineer.

\subsubsection{Alternate strategies.} Alternative strategies must be
given due consideration.

\subsubsection{Justify major changes.} If a strategy emerges that
seems promising, yet that strategy requires major changes to
ontologies, then these changes must be justified in terms of concrete
benefits of the new approach. Concrete problems with the existing
approach should be demonstrated.

\subsubsection{Clearly indicate shortcomings..} In a language that a
typical ontology developer can understand.

\subsubsection{Provide a road map.} If a promising strategy emerges,
then users should not be expected to migrate to it if there is no road
map indicating when missing features will be implemented. This would
be common sense in software engineering, the same principles should
apply to ontology engineering.  An example of where a road map is
missing is with the TR proposal. The release notes indicates that
solutions to the lack of instantiation of non-rigid classes and
permanent generic parthood are forthcoming, but there is no timeline.

\subsubsection{Provide a migration plan..} An alternate strategy must
come with a migration plan. I have experience in migration from legacy
systems (for example, the transition from obo-format to OWL). This is
rarely smooth, the process needs actively managed.

\subsubsection{Take advantage of FOL..} If the primary motivating
factor for a new approach is an FOL reading then the success of the
approach should be determined based on some machine-readable FOL.

\subsubsection{Provide tools..} If the use of a different approach
requires additional tools for ontology editors to work effectively,
then provide them, rather than promise them.

\subsubsection{Remember the limitations of OWL..} Much as I love OWL,
it isn't the right solution for everything. If you appear to be
overloading OWL, consider if you might be better using something
different.

\section{Conclusions}

Temporalized Relations would be a massive fundamental change to the
way relationships are modeled in ontologies. They would introduce
significant additional complexity to both users and developers of
ontologies.

Some of these costs could be justified if Temporalized Relations were
on a path towards making ontologies more biologically
accurate. However, there are are a lack motivating use cases for this
transition beyond the formal desire for a reading of the OWL in terms
of FOL. Migrating to Temporalized Relations would lead to ontologies
becoming \emph{less} accurate, in addition to more complex. This lack
of accuracy would have negative consequences on the utility OWL
reasoning, and would result in a FOL reading that is false for many
ontologies.

My recommendation is unambiguous in its rejection of the use of
Temporalized Relations in their current form in biological ontologies.

%\section*{References}

% ========================================
\bibliography{trc}
\bibliographystyle{plain}
% ========================================

\newpage
\section*{Appendix}

\subsection{Non-rigid classes}

A class $c$ is non-rigid if there exists an instance $i$ that exists
at $t_1$ and exists at $t_2$, and it is not the case that $i$
instantiates $c$ at $t_1$, and $i$ instantiates $c$ at $t_2$. $t_1$
may precede or succeed $t_2$.

\begin{enumerate}

\item 'premigratory neural crest cell' -- This is a cell that is part
  of the neural crest region of the neuroepithelium, prior to
  migration. Whilst not all instances of this class become migratory,
  many do. In this case we have a cell instance $i$ that instantiates
  'premigratory neural crest cell' at $t_1$ and then at a subsequent
  time $t_2$, it instantiates 'migratory neural crest
  cell'. Therefore, 'premigratory neural crest cell' is a non-rigid
  class. The \partOf\ relationship between this class and the neural
  crest cannot be adequately represented using TRs, because the cells
  may migrate.

\item 'human with Parkinson's disease' -- a person is not born with
  Parkinson's (although they may be born with genes that
  predispose). It is possible for a human being $i$ who exists at
  $t_1$ and $t_2$ to not instantiate human-with-PD at $t_1$ and to
  instantiate human-with-PD at $t_2$. Therefore human-with-PD is
  non-rigid. The \pr{has\_disposition}\ relationship between this class
  and the disease class cannot be adequately represented using TRs, as
  we need to say the members of the class have the disposition for all
  times that they instantiate the class.

\item 'female organism' -- Some organisms (e.g. some species of
  arthropod) can change sex during their lifetime. It is possible for
  some such instance $i$ to instantiate 'male organism' at $t_1$ and
  then instantiate 'female organism' at $t_2$. If these classes are
  disjoint, then 'female organism' is non-rigid. Note that it is
  possible to define different sex concepts (gender, karyotypic sex,
  biological sex, ...), different arguments can be made about the
  rigidity of the corresponding material entity classes.  The
  \pr{has\_quality}\ relationship between this class and the sex
  quality class cannot be adequately represented using TRs, as we need
  to say the members of the class have the quality for all times
  that they instantiate the class.


\item 'infected lung' -- it is possible for a lung $i$ to have the
  quality of being infected (alternatively: be the location of a
  population of invading organisms) at $t_1$, and then non-infected at
  $t_2$. Therefore the class 'infected lung' is non-rigid.  The
  \pr{location\_of}\ relationship between this class and the population
  class cannot be adequately represented using TRs, as we need to say
  the members of the class are the location for all times that they
  instantiate the class.


\item 'professor' -- It is possible for an individual $i$ to
  instantiate 'human with professor role' at one time, and then not
  instantiate this at some later time. Therefore 'professor' (as a
  material entity) is non-rigid. professorhood is best represented as
  a role that can be gained or lost.

  \item 'human patient' -- see 'professor'

  \item 'fractured bone' -- It is possible for some bone $i$ to
    instantiate the class 'non-fractured bone' at $t_1$ and then
    'fractured bone' at some later time $t_2$. Therefore 'fractured
    bone' (in the sense of a material entity - a bone that has the
    quality of being fractured) is a non-rigid class. An argument can
    be made that $i$ ceases to exist when it becomes fractured, and is
    replaced by a new individual $i_2$ at $t_2$. This could certainly
    be argued for severe breakages, where $i$ is replaced to two or
    more bone shards.

  \item 'happy human' -- It is possible for a human being $i$i to
    instantiate the class 'happy human' at $t_1$ (by virtue of bearing
    a happy disposition) and then 'unhappy human' at $t_2$. Therefore
    'happy human' is a non-rigid class. The \pr{has\_disposition}\
    relationship between this class and the disposition class cannot
    be adequately represented using TRs, as we need to say the members
    of the class have the disposition for all times that they
    instantiate the class.

  \item 'fetal heart' -- it is possible for a heart $i$ to instantiate
    'fetal heart' at $t_1$ and and then 'newborn heart' at
    $t_2$. Therefore 'fetal heart' is non-rigid. An argument can be
    made that $i$ is ceases to exist and is replaced by a new instance
    $i_2$ at $t_2$, but this would be unusual. An argument could also
    be made that there is no need for a class 'fetal heart' - the
    concept should be described using a rigid class 'heart' together
    with an occurrent 'fetal stage'. However, this would be a severely
    onerous penalty on many anatomy ontologies which frequently use
    stage as a differentia.

  \item 'open heart valve' -- it is possible for some heart valve $i$
    to instantiate 'open heart valve' at $t_1$ (by virtue of bearing
    the quality 'open' at this time, or, alternatively, by virtue of
    their being a lumen in the vessel) and then to instantiate 'closed
    heart valve' at $t_2$. Therefore 'open heart valve' is a non-rigid
    class.

  \item 'gravid uterus' -- it is possible for some uterus $i$ to
    instantiate a class 'non-gravid uterus' at time $t_1$ (by virtue
    of not being the location of a developing organism), and then
    instantiate a class 'gravid uterus' at some later time
    $t_2$. Therefore 'gravid uterus' is a non-rigid class. The
    \pr{has\_part}\ class axiom between this class and the embryo
    class cannot be adequately represented using TRs, as we need to
    say the members of the class are the location for all times that
    they instantiate the class.


  \item 'phosphorylated EGFR protein' -- there are different ways to
    model this depending on identity conditions on the instance level
    (we take identity conditions on the class level as being
    uncontroversial - class equivalence is determined by structure for
    molecules). Using model $M_1$, we assume there to be a single
    instance $i$ of an EGFR protein which transitions through
    different states. Here, $i$ instantiates 'unphosphorylated EGFR'
    at $t_1$ and then later the same instance $i$ instantiated
    'phosphorylated EGFR' at $t_2$. Under this model, 'phosphorylated
    EGFR' is non-rigid. We can model this differently - call this
    $M_2$. Here $i_1$ instantiates 'unphosphorylated EFGR' at
    $t_1$. Then, as a phosphate group is added at $t_2$, $i_1$ ceases
    to exist and its place is taken by $i_2$, which instantiates
    'phosphorylated EGFR'. Here $i_1$ and $i_2$ might be related via
    some relation such as 'transformation of'. This illustrates that
    any non-rigid class can be made rigid by changing instance-level
    identity conditions. At one extreme we can see life as a series of
    snapshots, with individuals living for an instant before being
    replaced by a doppelganger.

  \item 'cytoplasmic NFkB' -- this is similar to the EGFR case. Here
    the differentia is location. No structural change need take
    place. The \pr{located\_in}\ or \pr{part\_of}\ class axiom between
    this class and the cytoplasm class cannot be adequately
    represented using TRs, as we need to say the members of the class
    are part of the cytoplasm for all times that they instantiate the
    class.

  \item any leaf node from PATO -- Examples: square, open,
    cylindrical, hot, cold. This is a multi-faceted topic and a
    thorough discussion should wait until there is documentation on
    how to model quantities in BFO2.

\end{enumerate}


\subsection{Non-rigid qualities}

When considering BFO2 in particular, there is an interesting
pair of statements that are difficult to reconcile.

\begin{enumerate}

\item The reference document\cite{BFO2Ref} explicitly states that
  \emph{determinates} (for example, qualities such as ``square'',
  ``charged'', ``cylindrical'') are non-rigid

\item The BFO2 OWL Graz release notes\cite{Graz} explicitly states that
  instantiation of non-rigid classes is not supported in this version
  of BFO2, i.e. they have no model.

\end{enumerate}

The modeling implications of this disconnect are not clear (more
documentation would help). A reasonable interpretation might be that
leaf nodes of PATO are not supported in this version of BFO2.

It may be the case that future versions will address this, but there
is no guarantee that this will not involve additional complexity when
it comes to recording qualities.



\subsection{First order logic axioms}

This section contains some additional material on the first order
logic axioms supporting the Temporalized Relations. 

Table \ref{tab:fol-class-axioms} shows the FOL for the two main
temporalized versions of \partOf. Table
\ref{tab:fol-part-temporalized} shows the full FOL semantics of making
OWL class axioms using the FOL relations.


\begin{table}
\begin{tabular}{ | p{3cm} | p{4cm} | }
\hline
\textbf{Relation} & \textbf{Axiom}  \\
\hline
$$x\ \pr{part-of-}\ \atAllTimes\ y$$ &
        \tbleqn{
 & \dimp  \A t \existsAt(x,t) \imp\ \\
 & \existsAt(y,t), \partOf(x,y,t)
} \\
\hline
$$x\ \pr{part-of-}\ \atSomeTimes\ y$$ &
        \tbleqn{
 & \dimp  \E t \existsAt(x,t) \imp\ \\
 & \existsAt(y,t), \partOf(x,y,t)
} \\
\hline
\end{tabular}
\caption{Temporalized relations axioms for parthood relations. Taken from \cite{Graz} and transcribed into FOL syntax}
\label{tab:fol-part-temporalized}
\end{table}


\begin{table}
\begin{tabular}{ | p{1.8cm} | p{6.2cm} | }
\hline
\textbf{Axiom}  \\
\hline
\partOf (\OBOREL) &
        \tbleqn{
 & \A x \A t : \instanceOf(x, \CellNucleus, t) \imp \\
 & \E y : \instanceOf(y, \Cell, t), \partOf(x,y,t)
} \\
\hline
\pr{part-of-} \atAllTimes &
        \tbleqn{
 & \A x \E t : \instanceOf(x, \CellNucleus) \imp \\
 & \E y \instanceOf(y, \Cell), \A t \existsAt(x,t) \imp\ \\
 & \existsAt(y,t), \partOf(x,y,t)
} \\
\hline
\pr{part-of-} \atSomeTimes &
        \tbleqn{
 & \A x \E t : \instanceOf(x, \CellNucleus) \imp \\
 & \E y \instanceOf(y, \Cell), \E t \existsAt(x,t) \imp\ \\
 & \existsAt(y,t), \partOf(x,y,t)
} \\
\hline
\end{tabular}
\caption{
  Semantics of class axioms with parthood example. The first row shows the
  biologically correct relationship (permanent generic parthood), given by \OBOREL\ semantics. The next two rows show 
  two of the temporalized options - neither of these is equivalent to the \OBOREL\ version. 
}
\label{tab:fol-class-axioms}
\end{table}


\end{document}
